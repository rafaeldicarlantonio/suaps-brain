openapi: 3.1.0
info:
  title: SUAPS Agent API
  version: "1.0.0"
servers:
  - url: https://suaps-brain.onrender.com
paths:
  /healthz:
    get:
      operationId: healthz
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
  /chat:
    post:
      operationId: chat
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [message]   # user_id no longer required
              properties:
                user_id:
                  type: string
                  nullable: true
                user_email:
                  type: string
                  nullable: true
                session_id:
                  type: string
                  nullable: true
                message:
                  type: string
                history:
                  type: array
                  items:
                    type: object
                    required: [role, content]
                    properties:
                      role:
                        type: string
                        enum: [user, assistant, system]
                      content:
                        type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  session_id:
                    type: string
                  answer:
                    type: string
  /memories/upsert:
    post:
      operationId: upsertMemory
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [type, content]   # user_id no longer required
              properties:
                user_id:
                  type: string
                  nullable: true
                user_email:
                  type: string
                  nullable: true
                type:
                  type: string
                  enum: [episodic, semantic, procedural]
                title:
                  type: string
                content:
                  type: string
                importance:
                  type: integer
                  default: 3
                tags:
                  type: array
                  items:
                    type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
  /ingest/batch:
    post:
      operationId: ingestBatch
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [items]
              properties:
                items:
                  type: array
                  items:
                    type: object
                    requi
